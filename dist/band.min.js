/*! BandJS - v1.1.3 - 2016-08-07 */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.BandJS=t()}}(function(){return function t(e,n,r){function o(a,u){if(!n[a]){if(!e[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return o(n?n:t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){!function(t){"object"==typeof n&&(e.exports=t())}(function(){return window.AudioContext||window.webkitAudioContext})},{}],2:[function(t,e,n){function r(e,n){if(e||(e="equalTemperament"),n||(n="northAmerican"),"undefined"==typeof o.tuning[e])throw new Error(e+" is not a valid tuning pack.");if("undefined"==typeof o.rhythm[n])throw new Error(n+" is not a valid rhythm pack.");var r,i=this,a=function(){},u=t("audiocontext"),s={2:6,4:3,8:4.5};i.packs=o,i.pitches=o.tuning[e],i.notes=o.rhythm[n],i.audioContext=new u,i.masterVolumeLevel=null,i.masterVolume=i.audioContext.createGain(),i.masterVolume.connect(i.audioContext.destination),i.beatsPerBar=null,i.noteGetsBeat=null,i.tempo=null,i.instruments=[],i.totalDuration=0,i.currentSeconds=0,i.percentageComplete=0,i.noteBufferLength=20,i.onTickerCallback=a,i.onFinishedCallback=a,i.onDurationChangeCallback=a,i.load=function(t){if(i.instruments.length>0&&i.destroy(),!t)throw new Error("JSON is required for this method to work.");if("undefined"==typeof t.instruments)throw new Error("You must define at least one instrument");if("undefined"==typeof t.notes)throw new Error("You must define notes for each instrument");"undefined"!=typeof t.timeSignature&&i.setTimeSignature(t.timeSignature[0],t.timeSignature[1]),"undefined"!=typeof t.tempo&&i.setTempo(t.tempo);var e={};for(var n in t.instruments)t.instruments.hasOwnProperty(n)&&(e[n]=i.createInstrument(t.instruments[n].name,t.instruments[n].pack));for(var r in t.notes)if(t.notes.hasOwnProperty(r))for(var o=-1;++o<t.notes[r].length;){var a=t.notes[r][o];if("string"==typeof a){var u=a.split("|");"rest"===u[1]?e[r].rest(u[0]):e[r].note(u[0],u[1],u[2])}else"rest"===a.type?e[r].rest(a.rhythm):"note"===a.type&&e[r].note(a.rhythm,a.pitch,a.tie)}return i.finish()},i.createInstrument=function(e,n){var r=t("./instrument.js"),o=new r(e,n,i);return i.instruments.push(o),o},i.finish=function(){var e=t("./player.js");return r=new e(i)},i.destroy=function(){i.audioContext=new u,i.instruments.length=0,i.masterVolume=i.audioContext.createGain(),i.masterVolume.connect(i.audioContext.destination)},i.setMasterVolume=function(t){t>1&&(t/=100),i.masterVolumeLevel=t,i.masterVolume.gain.setValueAtTime(t,i.audioContext.currentTime)},i.getTotalSeconds=function(){return Math.round(i.totalDuration)},i.setTickerCallback=function(t){if("function"!=typeof t)throw new Error("Ticker must be a function.");i.onTickerCallback=t},i.setTimeSignature=function(t,e){if("undefined"==typeof s[e])throw new Error("The bottom time signature is not supported.");i.beatsPerBar=t,i.noteGetsBeat=s[e]},i.setTempo=function(t){i.tempo=60/t,r&&(r.resetTempo(),i.onDurationChangeCallback())},i.setOnFinishedCallback=function(t){if("function"!=typeof t)throw new Error("onFinished callback must be a function.");i.onFinishedCallback=t},i.setOnDurationChangeCallback=function(t){if("function"!=typeof t)throw new Error("onDurationChanged callback must be a function.");i.onDurationChangeCallback=t},i.setNoteBufferLength=function(t){i.noteBufferLength=t},i.setMasterVolume(100),i.setTempo(120),i.setTimeSignature(4,4)}e.exports=r;var o={instrument:{},rhythm:{},tuning:{}};r.loadPack=function(t,e,n){if(-1===["tuning","rhythm","instrument"].indexOf(t))throw new Error(t+" is not a valid Pack Type.");if("undefined"!=typeof o[t][e])throw new Error("A(n) "+t+' pack with the name "'+e+'" has already been loaded.');o[t][e]=n}},{"./instrument.js":5,"./player.js":7,audiocontext:1}],3:[function(t,e,n){function r(t,e){function n(t){for(var n=2*e.sampleRate,r=e.createBuffer(1,n,e.sampleRate),o=r.getChannelData(0),i=0;n>i;i++)o[i]=2*Math.random()-1;var a=e.createBufferSource();return a.buffer=r,a.loop=!0,a.connect(t),a}function r(t){var n,r,o,i,a,u,s,c=2*e.sampleRate,l=e.createBuffer(1,c,e.sampleRate),f=l.getChannelData(0);n=r=o=i=a=u=s=0;for(var m=0;c>m;m++){var p=2*Math.random()-1;n=.99886*n+.0555179*p,r=.99332*r+.0750759*p,o=.969*o+.153852*p,i=.8665*i+.3104856*p,a=.55*a+.5329522*p,u=-.7616*u-.016898*p,f[m]=n+r+o+i+a+u+s+.5362*p,f[m]*=.11,s=.115926*p}var d=e.createBufferSource();return d.buffer=l,d.loop=!0,d.connect(t),d}function o(t){for(var n=2*e.sampleRate,r=e.createBuffer(1,n,e.sampleRate),o=r.getChannelData(0),i=0,a=0;n>a;a++){var u=2*Math.random()-1;o[a]=(i+.02*u)/1.02,i=o[a],o[a]*=3.5}var s=e.createBufferSource();return s.buffer=r,s.loop=!0,s.connect(t),s}var i=["white","pink","brown","brownian","red"];if(-1===i.indexOf(t))throw new Error(t+" is not a valid noise sound");return{createNote:function(e){switch(t){case"white":return n(e);case"pink":return r(e);case"brown":case"brownian":case"red":return o(e)}}}}e.exports=r},{}],4:[function(t,e,n){function r(t,e){var n=["sine","square","sawtooth","triangle"];if(-1===n.indexOf(t))throw new Error(t+" is not a valid Oscillator type");return{createNote:function(n,r){var o=e.createOscillator();return o.connect(n),o.type=t,o.frequency.value=r,o}}}e.exports=r},{}],5:[function(t,e,n){function r(t,e,n){function r(t){if("undefined"==typeof n.notes[t])throw new Error(t+" is not a correct rhythm.");return n.notes[t]*n.tempo/n.noteGetsBeat*10}function o(t){if(null===t||"object"!=typeof t)return t;var e=t.constructor();for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}if(t||(t="sine"),e||(e="oscillators"),"undefined"==typeof n.packs.instrument[e])throw new Error(e+" is not a currently loaded Instrument Pack.");var i=this,a=0,u=1,s=.05;i.totalDuration=0,i.bufferPosition=0,i.instrument=n.packs.instrument[e](t,n.audioContext),i.notes=[],i.setVolume=function(t){return t>1&&(t/=100),u=t,i},i.note=function(t,e,o){var a=r(t),c=o?0:a*s;if(e){var l="";e=l+e,e=e.split(",");for(var f=-1;++f<e.length;){var m=e[f];if(m=m.trim(),"undefined"==typeof n.pitches[m]&&(m=parseFloat(m),isNaN(m)||0>m))throw new Error(m+" is not a valid pitch.")}}return i.notes.push({rhythm:t,pitch:e,duration:a,articulationGap:c,tie:o,startTime:i.totalDuration,stopTime:i.totalDuration+a-c,volumeLevel:u/4}),i.totalDuration+=a,i},i.rest=function(t){var e=r(t);return i.notes.push({rhythm:t,pitch:!1,duration:e,articulationGap:0,startTime:i.totalDuration,stopTime:i.totalDuration+e}),i.totalDuration+=e,i},i.repeatStart=function(){return a=i.notes.length,i},i.repeatFromBeginning=function(t){return a=0,i.repeat(t),i},i.repeat=function(t){t="undefined"==typeof t?1:t;for(var e=i.notes.slice(a),n=0;t>n;n++)for(var r=-1;++r<e.length;){var u=o(e[r]);u.startTime=i.totalDuration,u.stopTime=i.totalDuration+u.duration-u.articulationGap,i.notes.push(u),i.totalDuration+=u.duration}return i},i.resetDuration=function(){var t=-1,e=i.notes.length;for(i.totalDuration=0;++t<e;){var n=i.notes[t],o=r(n.rhythm),a=n.tie?0:o*s;n.duration=r(n.rhythm),n.startTime=i.totalDuration,n.stopTime=i.totalDuration+o-a,n.pitch!==!1&&(n.articulationGap=a),i.totalDuration+=o}}}e.exports=r},{}],6:[function(t,e,n){e.exports=t("./conductor.js"),e.exports.loadPack("instrument","noises",t("./instrument-packs/noises.js")),e.exports.loadPack("instrument","oscillators",t("./instrument-packs/oscillators.js")),e.exports.loadPack("rhythm","northAmerican",t("./rhythm-packs/north-american.js")),e.exports.loadPack("rhythm","european",t("./rhythm-packs/european.js")),e.exports.loadPack("rhythm","latino",t("./rhythm-packs/latino-american.js")),e.exports.loadPack("tuning","equalTemperament",t("./tuning-packs/equal-temperament.js")),e.exports.loadPack("tuning","equalProcedural",t("./tuning-packs/equal-procedural.js"))},{"./conductor.js":2,"./instrument-packs/noises.js":3,"./instrument-packs/oscillators.js":4,"./rhythm-packs/european.js":8,"./rhythm-packs/north-american.js":9,"./rhythm-packs/latino-american.js":10,"./tuning-packs/equal-temperament.js":11,"./tuning-packs/equal-procedural.js":12}],7:[function(t,e,n){function r(t){function e(e){for(var n=-1,i=t.instruments.length;++n<i;){var a=t.instruments[n];e&&a.resetDuration(),a.bufferPosition=0}for(e&&(r(),f=t.percentageComplete*t.totalDuration),n=-1;++n<l.length;)l[n].gain.disconnect();clearTimeout(u),l=o()}function n(e,n,r){if("undefined"==typeof r&&(r=!1),"up"!==e&&"down"!==e)throw new Error("Direction must be either up or down.");var o=.2;m="down"===e,"up"===e?(t.masterVolume.gain.linearRampToValueAtTime(0,t.audioContext.currentTime),t.masterVolume.gain.linearRampToValueAtTime(t.masterVolumeLevel,t.audioContext.currentTime+o)):(t.masterVolume.gain.linearRampToValueAtTime(t.masterVolumeLevel,t.audioContext.currentTime),t.masterVolume.gain.linearRampToValueAtTime(0,t.audioContext.currentTime+o)),setTimeout(function(){"function"==typeof n&&n.call(c),r&&(m=!m,t.masterVolume.gain.linearRampToValueAtTime(t.masterVolumeLevel,t.audioContext.currentTime))},1e3*o)}function r(){for(var e=-1,n=0;++e<t.instruments.length;){var r=t.instruments[e];r.totalDuration>n&&(n=r.totalDuration)}t.totalDuration=n}function o(){for(var e=[],n=-1,r=t.noteBufferLength;++n<t.instruments.length;){for(var o=t.instruments[n],i=r,a=-1;++a<i;){var u=o.notes[o.bufferPosition+a];if("undefined"==typeof u)break;var s=u.pitch,c=u.startTime,l=u.stopTime,m=u.volumeLevel;if(f>l)i++;else if(!1!==s){var p=t.audioContext.createGain();if(p.connect(t.masterVolume),p.gain.value=m,f>c&&(c=l-f),"undefined"==typeof s)e.push({startTime:f>c?l-f:c,stopTime:l,node:o.instrument.createNote(p),gain:p,volumeLevel:m});else for(var d=-1;++d<s.length;){var h=s[d];e.push({startTime:c,stopTime:l,node:o.instrument.createNote(p,t.pitches[h.trim()]||parseFloat(h)),gain:p,volumeLevel:m})}}}o.bufferPosition+=i}return e}function i(){!c.paused&&c.playing&&(t.totalDuration<f?(c.stop(!1),c.looping?c.play():t.onFinishedCallback()):(a(),setTimeout(i,1e3/60)))}function a(){f+=t.audioContext.currentTime-s;var e=Math.round(f);e!=t.currentSeconds&&(setTimeout(function(){t.onTickerCallback(e)},1),t.currentSeconds=e),t.percentageComplete=f/t.totalDuration,s=t.audioContext.currentTime}var u,s,c=this,l=o(),f=0,m=!1;r(),c.paused=!1,c.playing=!1,c.looping=!1,c.muted=!1,c.play=function(){c.playing=!0,c.paused=!1,s=t.audioContext.currentTime,i();var e=t.audioContext.currentTime-f,r=function(t){for(var n=-1;++n<t.length;){var r=t[n],o=r.startTime+e,i=r.stopTime+e;r.tie||(o>0&&(o-=.001),i+=.001,r.gain.gain.setValueAtTime(0,o),r.gain.gain.linearRampToValueAtTime(r.volumeLevel,o+.001),r.gain.gain.setValueAtTime(r.volumeLevel,i-.001),r.gain.gain.linearRampToValueAtTime(0,i)),r.node.start(o),r.node.stop(i)}},a=function(){u=setTimeout(function(){if(c.playing&&!c.paused){var t=o();t.length>0&&(r(t),l=l.concat(t),a())}},5e3*t.tempo)};r(l),a(),m&&!c.muted&&n("up")},c.stop=function(r){c.playing=!1,t.currentSeconds=0,t.percentageComplete=0,"undefined"==typeof r&&(r=!0),r&&!c.muted?n("down",function(){f=0,e(),setTimeout(function(){t.onTickerCallback(t.currentSeconds)},1)},!0):(f=0,e(),setTimeout(function(){t.onTickerCallback(t.currentSeconds)},1))},c.pause=function(){c.paused=!0,a(),c.muted?e():n("down",function(){e()})},c.loop=function(t){c.looping=!!t},c.setTime=function(t){f=parseInt(t),e(),c.playing&&!c.paused&&c.play()},c.resetTempo=function(){e(!0),c.playing&&!c.paused&&c.play()},c.mute=function(t){c.muted=!0,n("down",t)},c.unmute=function(t){c.muted=!1,n("up",t)}}e.exports=r},{}],8:[function(t,e,n){e.exports={semibreve:1,dottedMinim:.75,minim:.5,dottedCrotchet:.375,tripletMinim:.33333334,crotchet:.25,dottedQuaver:.1875,tripletCrotchet:.166666667,quaver:.125,dottedSemiquaver:.09375,tripletQuaver:.083333333,semiquaver:.0625,tripletSemiquaver:.041666667,demisemiquaver:.03125}},{}],9:[function(t,e,n){e.exports={whole:1,dottedHalf:.75,half:.5,dottedQuarter:.375,tripletHalf:.33333334,quarter:.25,dottedEighth:.1875,tripletQuarter:.166666667,eighth:.125,dottedSixteenth:.09375,tripletEighth:.083333333,sixteenth:.0625,tripletSixteenth:.041666667,thirtySecond:.03125}},{}],10:[function(t,e,n){e.exports={1:.0625,2:.125,3:.1875,4:.25,5:.3125,6:.375,7:.4375,8:.5,9:.5625,10:.625,11:.6875,12:.75,13:.8125,14:.875,15:.9375,16:1}},{}],11:[function(t,e,n){e.exports={C0:16.35,"C#0":17.32,Db0:17.32,D0:18.35,"D#0":19.45,Eb0:19.45,E0:20.6,F0:21.83,"F#0":23.12,Gb0:23.12,G0:24.5,"G#0":25.96,Ab0:25.96,A0:27.5,"A#0":29.14,Bb0:29.14,B0:30.87,C1:32.7,"C#1":34.65,Db1:34.65,D1:36.71,"D#1":38.89,Eb1:38.89,E1:41.2,F1:43.65,"F#1":46.25,Gb1:46.25,G1:49,"G#1":51.91,Ab1:51.91,A1:55,"A#1":58.27,Bb1:58.27,B1:61.74,C2:65.41,"C#2":69.3,Db2:69.3,D2:73.42,"D#2":77.78,Eb2:77.78,E2:82.41,F2:87.31,"F#2":92.5,Gb2:92.5,G2:98,"G#2":103.83,Ab2:103.83,A2:110,"A#2":116.54,Bb2:116.54,B2:123.47,C3:130.81,"C#3":138.59,Db3:138.59,D3:146.83,"D#3":155.56,Eb3:155.56,E3:164.81,F3:174.61,"F#3":185,Gb3:185,G3:196,"G#3":207.65,Ab3:207.65,A3:220,"A#3":233.08,Bb3:233.08,B3:246.94,C4:261.63,"C#4":277.18,Db4:277.18,D4:293.66,"D#4":311.13,Eb4:311.13,E4:329.63,F4:349.23,"F#4":369.99,Gb4:369.99,G4:392,"G#4":415.3,Ab4:415.3,A4:440,"A#4":466.16,Bb4:466.16,B4:493.88,C5:523.25,"C#5":554.37,Db5:554.37,D5:587.33,"D#5":622.25,Eb5:622.25,E5:659.26,F5:698.46,"F#5":739.99,Gb5:739.99,G5:783.99,"G#5":830.61,Ab5:830.61,A5:880,"A#5":932.33,Bb5:932.33,B5:987.77,C6:1046.5,"C#6":1108.73,Db6:1108.73,D6:1174.66,"D#6":1244.51,Eb6:1244.51,E6:1318.51,F6:1396.91,"F#6":1479.98,Gb6:1479.98,G6:1567.98,"G#6":1661.22,Ab6:1661.22,A6:1760,"A#6":1864.66,Bb6:1864.66,B6:1975.53,C7:2093,"C#7":2217.46,Db7:2217.46,D7:2349.32,"D#7":2489.02,Eb7:2489.02,E7:2637.02,F7:2793.83,"F#7":2959.96,Gb7:2959.96,G7:3135.96,"G#7":3322.44,Ab7:3322.44,A7:3520,"A#7":3729.31,Bb7:3729.31,B7:3951.07,C8:4186.01}},{}],12:[function(t,e,n){e.exports={1:16.35,9:17.32,16:17.32,2:18.35,17:19.45,24:19.45,3:20.6,4:21.83,33:23.12,40:23.12,5:24.5,41:25.96,48:25.96,6:27.5,49:29.14,56:29.14,7:30.87,11:32.7,111:34.65,120:34.65,12:36.71,121:38.89,130:38.89,13:41.2,14:43.65,141:46.25,150:46.25,15:49,151:51.91,160:51.91,16:55,161:58.27,170:58.27,17:61.74,21:65.41,211:69.3,220:69.3,22:73.42,221:77.78,230:77.78,23:82.41,24:87.31,241:92.5,250:92.5,25:98,251:103.83,260:103.83,26:110,261:116.54,270:116.54,27:123.47,31:130.81,311:138.59,320:138.59,32:146.83,321:155.56,330:155.56,33:164.81,34:174.61,341:185,350:185,35:196,351:207.65,360:207.65,36:220,361:233.08,370:233.08,37:246.94,41:261.63,411:277.18,420:277.18,42:293.66,421:311.13,430:311.13,43:329.63,44:349.23,441:369.99,450:369.99,45:392,451:415.3,460:415.3,46:440,461:466.16,470:466.16,47:493.88,51:523.25,511:554.37,520:554.37,52:587.33,521:622.25,530:622.25,53:659.26,54:698.46,541:739.99,550:739.99,55:783.99,551:830.61,560:830.61,56:880,561:932.33,570:932.33,57:987.77,61:1046.5,611:1108.73,620:1108.73,62:1174.66,621:1244.51,630:1244.51,63:1318.51,64:1396.91,641:1479.98,650:1479.98,65:1567.98,651:1661.22,660:1661.22,66:1760,661:1864.66,670:1864.66,67:1975.53,71:2093,711:2217.46,720:2217.46,72:2349.32,721:2489.02,730:2489.02,73:2637.02,74:2793.83,741:2959.96,750:2959.96,75:3135.96,751:3322.44,760:3322.44,76:3520,761:3729.31,770:3729.31,77:3951.07,81:4186.01}},{}]},{},[6])(6)});
